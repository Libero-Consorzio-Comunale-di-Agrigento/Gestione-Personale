delete from  CASELLE_FISCALI
where anno = 2005
and tipo_dichiarazione = 'C';

INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 1, 'Casella 1', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 2, 'Casella 2', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 3, 'Casella 3', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 4, 'Casella 4', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 5, 'Casella 5', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 6, 'Casella 6', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 7, 'Casella 7', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 8, 'Casella 8', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 9, 'Casella 9', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 10, 'Casella 10', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 11, 'Casella 11', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 12, 'Casella 12', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 13, 'Casella 13', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 14, 'Casella 14', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 15, 'Casella 15', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 16, 'Casella 16', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 17, 'Casella 17', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 18, 'Casella 18', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 19, 'Casella 19', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 20, 'Casella 20', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 21, 'Casella 21', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 22, 'Casella 22', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 26, 'Casella 26', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 27, 'Casella 27', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 28, 'Casella 28', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 29, 'Casella 29', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 30, 'Casella 30', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 31, 'Casella 31', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 33, 'Casella 33', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 34, 'Casella 34', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 35, 'Casella 35', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 36, 'Casella 36', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 43, 'Casella 43', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 44, 'Casella 44', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 45, 'Casella 45', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 46, 'Casella 46', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 57, 'Casella 57', 'D', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 58, 'Casella 58', 'D', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 59, 'Casella 59', 'D', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 60, 'Casella 60', 'D', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 68, 'Casella 68', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 69, 'Casella 69', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 70, 'Casella 70', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 71, 'Casella 71', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 72, 'Casella 72', 'T', '103'); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 81, 'Prev.Casella 68', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 82, 'Prev.Casella 69', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 83, 'Prev.Casella 70', 'T', '136'); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 103, 'Cas.8 Prev.Com.', 'T', '141'); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 136, 'Prev.Cas.74', 'T', '137'); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 137, 'Prev.Cas.75', 'T', '138'); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 138, 'Prev.Cas.76', 'T', '139'); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 139, 'App. per Note', 'T', NULL); 
INSERT INTO CASELLE_FISCALI ( ANNO, TIPO_DICHIARAZIONE, SEQUENZA, DESCRIZIONE, TIPO_CASELLA,
CASELLA_DETT ) VALUES ( 
2005, 'C', 141, 'Prev - Cas.5', 'T', '81');

-- Definizione nuove testate del DESRE e inserimento voci da DCOVO
-- delete from ESTRAZIONE_VALORI_CONTABILI where estrazione = 'DENUNCIA_CUD'
-- and colonna in ( 'SOMME_00','SOMME_09','SOMME_10','SOMME_13','SOMME_14');

INSERT INTO ESTRAZIONE_VALORI_CONTABILI
( ESTRAZIONE, COLONNA, DAL, AL, DESCRIZIONE, SEQUENZA, NOTE, MOLTIPLICA, ARROTONDA, DIVIDE ) 
VALUES ( 'DENUNCIA_CUD', 'SOMME_00',  TO_Date( '01/01/2000 12:00:00 AM', 'MM/DD/YYYY HH:MI:SS AM')
, NULL, 'Compensi in Natura - per Annotazioni', 80, NULL, NULL, NULL, NULL); 
INSERT INTO ESTRAZIONE_VALORI_CONTABILI
( ESTRAZIONE, COLONNA, DAL, AL, DESCRIZIONE, SEQUENZA, NOTE, MOLTIPLICA, ARROTONDA, DIVIDE ) 
VALUES ( 'DENUNCIA_CUD', 'SOMME_09',  TO_Date( '01/01/2000 12:00:00 AM', 'MM/DD/YYYY HH:MI:SS AM')
, NULL, 'Erogazioni Liberali - per Annotazioni', 80, NULL, NULL, NULL, NULL); 
INSERT INTO ESTRAZIONE_VALORI_CONTABILI
( ESTRAZIONE, COLONNA, DAL, AL, DESCRIZIONE, SEQUENZA, NOTE, MOLTIPLICA, ARROTONDA, DIVIDE ) 
VALUES ( 'DENUNCIA_CUD', 'SOMME_10',  TO_Date( '01/01/2000 12:00:00 AM', 'MM/DD/YYYY HH:MI:SS AM')
, NULL, 'Contr. prev. complementare - casella 28/29 CUD 2006', 80, NULL, NULL, NULL, NULL); 
INSERT INTO ESTRAZIONE_VALORI_CONTABILI
( ESTRAZIONE, COLONNA, DAL, AL, DESCRIZIONE, SEQUENZA, NOTE, MOLTIPLICA, ARROTONDA, DIVIDE ) 
VALUES ( 'DENUNCIA_CUD', 'SOMME_11',  TO_Date( '01/01/2000 12:00:00 AM', 'MM/DD/YYYY HH:MI:SS AM')
, NULL, 'Add.reg.sospesa da PDDL - casella del 770 ', 80, NULL, NULL, NULL, NULL); 
INSERT INTO ESTRAZIONE_VALORI_CONTABILI
( ESTRAZIONE, COLONNA, DAL, AL, DESCRIZIONE, SEQUENZA, NOTE, MOLTIPLICA, ARROTONDA, DIVIDE ) 
VALUES ( 'DENUNCIA_CUD', 'SOMME_12',  TO_Date( '01/01/2000 12:00:00 AM', 'MM/DD/YYYY HH:MI:SS AM')
, NULL, 'Add.com.sospesa da PDDL - casella del 770 ', 80, NULL, NULL, NULL, NULL); 
INSERT INTO ESTRAZIONE_VALORI_CONTABILI
( ESTRAZIONE, COLONNA, DAL, AL, DESCRIZIONE, SEQUENZA, NOTE, MOLTIPLICA, ARROTONDA, DIVIDE ) 
VALUES ( 'DENUNCIA_CUD', 'SOMME_13',  TO_Date( '01/01/2000 12:00:00 AM', 'MM/DD/YYYY HH:MI:SS AM')
, NULL, 'Presenza di Assicurazioni Sanitarie - casella 34 CUD 2006', 80, NULL, NULL, NULL, NULL); 
INSERT INTO ESTRAZIONE_VALORI_CONTABILI
( ESTRAZIONE, COLONNA, DAL, AL, DESCRIZIONE, SEQUENZA, NOTE, MOLTIPLICA, ARROTONDA, DIVIDE ) 
VALUES ( 'DENUNCIA_CUD', 'SOMME_14',  TO_Date( '01/01/2000 12:00:00 AM', 'MM/DD/YYYY HH:MI:SS AM')
, NULL, 'Contr. versati a enti assistenziali - casella 33 CUD 2006', 80, NULL, NULL, NULL, NULL);
INSERT INTO ESTRAZIONE_VALORI_CONTABILI
( ESTRAZIONE, COLONNA, DAL, AL, DESCRIZIONE, SEQUENZA, NOTE, MOLTIPLICA, ARROTONDA, DIVIDE ) 
VALUES ( 'DENUNCIA_CUD', 'SOMME_16',  TO_Date( '01/01/2000 12:00:00 AM', 'MM/DD/YYYY HH:MI:SS AM')
, NULL, 'Ritenute sospese da PDDL - casella del 770 ', 80, NULL, NULL, NULL, NULL); 


DECLARE 
D_sequenza number := 0;
BEGIN
D_sequenza := 0;
-- Caricamento ex somme 0
FOR CUR_VOCE_0 IN 
( select distinct voce, sub 
    from contabilita_voce
   where somme = '0'
     and al is null
) LOOP
  D_sequenza := D_sequenza + 1;
  insert into ESTRAZIONE_RIGHE_CONTABILI
  (ESTRAZIONE, COLONNA, DAL, AL, SEQUENZA, VOCE, SUB, TIPO )
  select esvc.estrazione, esvc.colonna, esvc.dal, esvc.al
       , D_sequenza, CUR_VOCE_0.voce, CUR_VOCE_0.sub, 'P'
    from ESTRAZIONE_VALORI_CONTABILI esvc
   where esvc.estrazione = 'DENUNCIA_CUD'
     and colonna = 'SOMME_00'
     and al is null
     and not exists ( select 'x' 
                        from ESTRAZIONE_RIGHE_CONTABILI
                       where estrazione = esvc.estrazione
                         and colonna = esvc.colonna
                         and dal = esvc.dal
                         and sequenza = D_sequenza
                         and voce = CUR_VOCE_0.voce
                         and sub = CUR_VOCE_0.sub
                    );
  commit;
  END LOOP;
D_sequenza := 0;
-- Caricamento ex somme 6
FOR CUR_VOCE_6 IN 
( select distinct voce, sub 
    from contabilita_voce
   where somme = '6'
     and al is null
) LOOP
  D_sequenza := D_sequenza + 1;
  insert into ESTRAZIONE_RIGHE_CONTABILI
  (ESTRAZIONE, COLONNA, DAL, AL, SEQUENZA, VOCE, SUB, TIPO )
  select esvc.estrazione, esvc.colonna, esvc.dal, esvc.al
       , D_sequenza, CUR_VOCE_6.voce, CUR_VOCE_6.sub, 'P'
    from ESTRAZIONE_VALORI_CONTABILI esvc
   where esvc.estrazione = 'DENUNCIA_CUD'
     and colonna = 'SOMME_09'
     and al is null
     and not exists ( select 'x' 
                        from ESTRAZIONE_RIGHE_CONTABILI
                       where estrazione = esvc.estrazione
                         and colonna = esvc.colonna
                         and dal = esvc.dal
                         and sequenza = D_sequenza
                         and voce = CUR_VOCE_6.voce
                         and sub = CUR_VOCE_6.sub
                    );
  commit;
  END LOOP;
D_sequenza := 0;
-- Caricamento ex somme 10
FOR CUR_VOCE_10 IN 
( select distinct voce, sub 
    from contabilita_voce
   where somme = '10'
     and al is null
) LOOP
  D_sequenza := D_sequenza + 1;
  insert into ESTRAZIONE_RIGHE_CONTABILI
  (ESTRAZIONE, COLONNA, DAL, AL, SEQUENZA, VOCE, SUB, TIPO )
  select esvc.estrazione, esvc.colonna, esvc.dal, esvc.al
       , D_sequenza, CUR_VOCE_10.voce, CUR_VOCE_10.sub, 'P'
    from ESTRAZIONE_VALORI_CONTABILI esvc
   where esvc.estrazione = 'DENUNCIA_CUD'
     and colonna = 'SOMME_10'
     and al is null
     and not exists ( select 'x' 
                        from ESTRAZIONE_RIGHE_CONTABILI
                       where estrazione = esvc.estrazione
                         and colonna = esvc.colonna
                         and dal = esvc.dal
                         and sequenza = D_sequenza
                         and voce = CUR_VOCE_10.voce
                         and sub = CUR_VOCE_10.sub
                    );
  commit;
  END LOOP;
D_sequenza := 0;
-- Caricamento ex somme 13
FOR CUR_VOCE_13 IN 
( select distinct voce, sub 
    from contabilita_voce
   where somme = '13'
     and al is null
) LOOP
  D_sequenza := D_sequenza + 1;
  insert into ESTRAZIONE_RIGHE_CONTABILI
  (ESTRAZIONE, COLONNA, DAL, AL, SEQUENZA, VOCE, SUB, TIPO )
  select esvc.estrazione, esvc.colonna, esvc.dal, esvc.al
       , D_sequenza, CUR_VOCE_13.voce, CUR_VOCE_13.sub, 'P'
    from ESTRAZIONE_VALORI_CONTABILI esvc
   where esvc.estrazione = 'DENUNCIA_CUD'
     and colonna = 'SOMME_13'
     and al is null
     and not exists ( select 'x' 
                        from ESTRAZIONE_RIGHE_CONTABILI
                       where estrazione = esvc.estrazione
                         and colonna = esvc.colonna
                         and dal = esvc.dal
                         and sequenza = D_sequenza
                         and voce = CUR_VOCE_13.voce
                         and sub = CUR_VOCE_13.sub
                    );
  commit;
  END LOOP;
D_sequenza := 0;
-- Caricamento ex somme 14
FOR CUR_VOCE_14 IN 
( select distinct voce, sub 
    from contabilita_voce
   where somme = '14'
     and al is null
) LOOP
  D_sequenza := D_sequenza + 1;
  insert into ESTRAZIONE_RIGHE_CONTABILI
  (ESTRAZIONE, COLONNA, DAL, AL, SEQUENZA, VOCE, SUB, TIPO )
  select esvc.estrazione, esvc.colonna, esvc.dal, esvc.al
       , D_sequenza, CUR_VOCE_14.voce, CUR_VOCE_14.sub, 'P'
    from ESTRAZIONE_VALORI_CONTABILI esvc
   where esvc.estrazione = 'DENUNCIA_CUD'
     and colonna = 'SOMME_14'
     and al is null
     and not exists ( select 'x' 
                        from ESTRAZIONE_RIGHE_CONTABILI
                       where estrazione = esvc.estrazione
                         and colonna = esvc.colonna
                         and dal = esvc.dal
                         and sequenza = D_sequenza
                         and voce = CUR_VOCE_14.voce
                         and sub = CUR_VOCE_14.sub
                    );
  commit;
  END LOOP;
D_sequenza := 0;
-- Caricamento ex somme 11
FOR CUR_VOCE_11 IN 
( select distinct voce, sub 
    from contabilita_voce
   where somme = '11'
     and al is null
) LOOP
  D_sequenza := D_sequenza + 1;
  insert into ESTRAZIONE_RIGHE_CONTABILI
  (ESTRAZIONE, COLONNA, DAL, AL, SEQUENZA, VOCE, SUB, TIPO )
  select esvc.estrazione, esvc.colonna, esvc.dal, esvc.al
       , D_sequenza, CUR_VOCE_11.voce, CUR_VOCE_11.sub, 'P'
    from ESTRAZIONE_VALORI_CONTABILI esvc
   where esvc.estrazione = 'DENUNCIA_CUD'
     and colonna = 'SOMME_11'
     and al is null
     and not exists ( select 'x' 
                        from ESTRAZIONE_RIGHE_CONTABILI
                       where estrazione = esvc.estrazione
                         and colonna = esvc.colonna
                         and dal = esvc.dal
                         and sequenza = D_sequenza
                         and voce = CUR_VOCE_11.voce
                         and sub = CUR_VOCE_11.sub
                    );
  commit;
  END LOOP;
D_sequenza := 0;
-- Caricamento ex somme 12
FOR CUR_VOCE_12 IN 
( select distinct voce, sub 
    from contabilita_voce
   where somme = '12'
     and al is null
) LOOP
  D_sequenza := D_sequenza + 1;
  insert into ESTRAZIONE_RIGHE_CONTABILI
  (ESTRAZIONE, COLONNA, DAL, AL, SEQUENZA, VOCE, SUB, TIPO )
  select esvc.estrazione, esvc.colonna, esvc.dal, esvc.al
       , D_sequenza, CUR_VOCE_12.voce, CUR_VOCE_12.sub, 'P'
    from ESTRAZIONE_VALORI_CONTABILI esvc
   where esvc.estrazione = 'DENUNCIA_CUD'
     and colonna = 'SOMME_12'
     and al is null
     and not exists ( select 'x' 
                        from ESTRAZIONE_RIGHE_CONTABILI
                       where estrazione = esvc.estrazione
                         and colonna = esvc.colonna
                         and dal = esvc.dal
                         and sequenza = D_sequenza
                         and voce = CUR_VOCE_12.voce
                         and sub = CUR_VOCE_12.sub
                    );
  commit;
  END LOOP;
D_sequenza := 0;
-- Caricamento ex somme 16
FOR CUR_VOCE_16 IN 
( select distinct voce, sub 
    from contabilita_voce
   where somme = '16'
     and al is null
) LOOP
  D_sequenza := D_sequenza + 1;
  insert into ESTRAZIONE_RIGHE_CONTABILI
  (ESTRAZIONE, COLONNA, DAL, AL, SEQUENZA, VOCE, SUB, TIPO )
  select esvc.estrazione, esvc.colonna, esvc.dal, esvc.al
       , D_sequenza, CUR_VOCE_16.voce, CUR_VOCE_16.sub, 'P'
    from ESTRAZIONE_VALORI_CONTABILI esvc
   where esvc.estrazione = 'DENUNCIA_CUD'
     and colonna = 'SOMME_16'
     and al is null
     and not exists ( select 'x' 
                        from ESTRAZIONE_RIGHE_CONTABILI
                       where estrazione = esvc.estrazione
                         and colonna = esvc.colonna
                         and dal = esvc.dal
                         and sequenza = D_sequenza
                         and voce = CUR_VOCE_16.voce
                         and sub = CUR_VOCE_16.sub
                    );
  commit;
  END LOOP;
END;
/

-- Modifica parametro per CNOCU

delete from a_selezioni where voce_menu = 'PECCARFI' and parametro = 'P_ANNO_SFASATO';
insert into a_selezioni (parametro,voce_menu,sequenza,descrizione,lunghezza,formato,obbligo,valore_default,dominio,alias,gruppo_alias,numero_fk) 
values ('P_ANNO_SFASATO','PECCARFI','7','Anno Prev.da Nov.(note gg.det)','1','U','N','','P_X','','','');

start crp_peccarfi.sql